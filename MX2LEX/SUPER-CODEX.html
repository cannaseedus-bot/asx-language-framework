<!DOCTYPE html><html lang="en"><head>  <meta charset="UTF-8" />  <title>ASX ATOMIC MEGA CODEX — Hazard Ω Edition</title>  <meta name="viewport" content="width=device-width, initial-scale=1" />  <meta name="theme-color" content="#020712" />  <link rel="manifest" href="manifest.json" />  <style>    :root {      --bg: #020409;      --bg-alt: #050912;      --panel: #050a14;      --border: #16f2aa;      --border-soft: rgba(22,242,170,0.25);      --accent: #00ffd0;      --accent-soft: rgba(0,255,208,0.12);      --accent2: #44ff88;      --danger: #f25c5c;      --text: #e8fff6;      --muted: #7e8a92;      --shadow-soft: 0 18px 48px rgba(0,0,0,0.75);      --radius-lg: 18px;      --radius-md: 12px;      --radius-pill: 999px;      --transition-fast: 0.18s ease-out;      /* Hazard layer */      --hazard: #ffb300;      --hazard-soft: rgba(255,179,0,0.16);      --hazard-glow: 0 0 16px rgba(255,179,0,0.65);    }    * { box-sizing: border-box; }    html, body {      height: 100%;      margin: 0;      padding: 0;    }    body {      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",        "Segoe UI", sans-serif;      background: radial-gradient(circle at 0 0, #041725 0, #020409 55%);      color: var(--text);      display: flex;      flex-direction: column;      overflow: hidden;    }    /* HUD HEADER ---------------------------------------------------------- */    header.hud {      position: relative;      z-index: 10;      background: radial-gradient(circle at 0 0, rgba(0,255,153,0.12) 0, rgba(0,0,0,0.7) 45%);      border-bottom: 1px solid rgba(0,255,153,0.35);      backdrop-filter: blur(8px);      box-shadow: 0 12px 40px rgba(0,0,0,0.66);    }    header .wrap {      max-width: 1440px;      margin: 0 auto;      padding: 0.75rem 1.5rem;      display: flex;      align-items: center;      justify-content: space-between;      gap: 1rem;    }    .logo-mark {      display: flex;      align-items: center;      gap: 0.6rem;    }    .logo-glyph {      width: 32px;      height: 32px;      border-radius: 40% 65% 38% 70%;      background: radial-gradient(circle at 30% 20%, #00ffd0 0, #059669 35%, #020409 80%);      box-shadow:        0 0 22px rgba(0,255,153,0.6),        0 0 60px rgba(0,0,0,0.9);      position: relative;      overflow: hidden;    }    .logo-glyph::after {      content: "";      position: absolute;      inset: 28%;      border-radius: inherit;      border: 1px solid rgba(0,0,0,0.55);      box-shadow: inset 0 0 14px rgba(0,0,0,0.8);    }    .logo-text-main {      font-size: 1rem;      letter-spacing: 0.12em;      text-transform: uppercase;      color: var(--accent);    }    .logo-text-sub {      font-size: 0.7rem;      letter-spacing: 0.16em;      text-transform: uppercase;      color: var(--muted);    }    .hud-status {      display: flex;      align-items: center;      gap: 0.5rem;      font-size: 0.75rem;      text-transform: uppercase;      letter-spacing: 0.18em;      color: var(--muted);    }    .led {      width: 11px;      height: 11px;      border-radius: 50%;      background: #0f172a;      box-shadow: 0 0 0 rgba(22,242,170,0);      position: relative;      overflow: hidden;    }    .led.on {      background: var(--accent2);      box-shadow:        0 0 12px rgba(68,255,136,0.9),        0 0 32px rgba(0,0,0,0.85);    }    .hud-pill {      border-radius: var(--radius-pill);      border: 1px solid rgba(148,163,184,0.6);      padding: 0.12rem 0.7rem;      font-size: 0.7rem;      color: var(--muted);    }    /* LAYOUT -------------------------------------------------------------- */    .shell {      flex: 1;      display: grid;      grid-template-columns: 260px minmax(0, 1fr);      max-width: 1440px;      margin: 0.5rem auto 1rem auto;      padding: 0 1.5rem 1.5rem 1.5rem;      gap: 1rem;      height: calc(100vh - 64px);    }    @media (max-width: 900px) {      .shell {        grid-template-columns: minmax(0, 1fr);        grid-template-rows: auto minmax(0, 1fr);        padding-inline: 0.75rem;      }    }    /* SIDEBAR / TABS ------------------------------------------------------ */    .nav-panel {      background: radial-gradient(circle at 0 0, #071827 0, #020713 65%);      border-radius: var(--radius-lg);      border: 1px solid var(--border-soft);      box-shadow: var(--shadow-soft);      padding: 0.9rem;      display: flex;      flex-direction: column;      gap: 0.75rem;      overflow: hidden;    }    .nav-title {      font-size: 0.75rem;      letter-spacing: 0.2em;      text-transform: uppercase;      color: var(--muted);      display: flex;      justify-content: space-between;      align-items: center;      gap: 0.3rem;    }    .nav-title span:last-child {      font-size: 0.7rem;      color: var(--accent);    }    .nav-search {      position: relative;    }    .nav-search input {      width: 100%;      padding: 0.4rem 0.7rem;      padding-left: 1.6rem;      border-radius: var(--radius-pill);      border: 1px solid rgba(51,65,85,0.95);      background: radial-gradient(circle at 0 0, rgba(15,23,42,0.86) 0, #020409 55%);      color: var(--text);      font-size: 0.78rem;      outline: none;    }    .nav-search input::placeholder {      color: rgba(148,163,184,0.8);    }    .nav-search-icon {      position: absolute;      left: 0.55rem;      top: 50%;      transform: translateY(-50%);      font-size: 0.75rem;      color: rgba(148,163,184,0.9);    }    .nav-list {      list-style: none;      padding: 0;      margin: 0;      display: flex;      flex-direction: column;      gap: 0.25rem;      overflow: auto;    }    .nav-item {      border-radius: 999px;      border: 1px solid transparent;      padding: 0.32rem 0.65rem;      display: flex;      flex-direction: column;      gap: 0.05rem;      cursor: pointer;      transition:        background var(--transition-fast),        border-color var(--transition-fast),        transform 0.12s ease-out,        box-shadow 0.12s ease-out;      position: relative;    }    .nav-item:hover {      background: radial-gradient(circle at 0 0, var(--hazard-soft) 0, rgba(15,23,42,0.9) 65%);      border-color: var(--hazard);      transform: translateX(3px);      box-shadow: var(--hazard-glow);    }    .nav-item.active {      background: radial-gradient(circle at 0 0, rgba(255,179,0,0.28) 0, rgba(6,12,20,0.98) 65%);      border-color: var(--hazard);      box-shadow:        0 0 0 1px rgba(255,179,0,0.35),        0 0 22px rgba(255,179,0,0.65);    }    .nav-item-title {      font-size: 0.78rem;      letter-spacing: 0.12em;      text-transform: uppercase;      color: var(--accent);      display: flex;      align-items: center;      justify-content: space-between;      gap: 0.3rem;    }    .nav-item-sub {      font-size: 0.7rem;      color: var(--muted);      white-space: nowrap;      overflow: hidden;      text-overflow: ellipsis;    }    .nav-chip {      font-size: 0.65rem;      padding: 0.05rem 0.4rem;      border-radius: 999px;      border: 1px solid rgba(148,163,184,0.8);      color: rgba(148,163,184,0.9);    }    .nav-chip.hazard {      border-color: var(--hazard);      color: var(--hazard);    }    /* MAIN PANEL ---------------------------------------------------------- */    .main-panel {      background: radial-gradient(circle at 0 0, #071827 0, #020409 65%);      border-radius: var(--radius-lg);      border: 1px solid rgba(15,23,42,0.9);      box-shadow: var(--shadow-soft);      padding: 1rem 1.1rem 1.1rem 1.1rem;      display: flex;      flex-direction: column;      overflow: hidden;      position: relative;    }    .main-header {      display: flex;      align-items: center;      justify-content: space-between;      gap: 1rem;      padding-bottom: 0.35rem;      border-bottom: 1px solid rgba(15,23,42,0.9);      margin-bottom: 0.35rem;    }    .main-title-block {      display: flex;      flex-direction: column;      gap: 0.2rem;    }    .main-title {      font-size: 0.92rem;      letter-spacing: 0.22em;      text-transform: uppercase;      color: var(--accent);    }    .main-subtitle {      font-size: 0.74rem;      color: var(--muted);      max-width: 520px;    }    .main-meta {      display: flex;      align-items: center;      gap: 0.4rem;      flex-wrap: wrap;      justify-content: flex-end;      font-size: 0.7rem;    }    .badge {      border-radius: 999px;      padding: 0.16rem 0.6rem;      border: 1px solid rgba(148,163,184,0.7);      color: rgba(148,163,184,0.9);      background: radial-gradient(circle at 0 0, rgba(15,23,42,0.85) 0, #020409 68%);    }    .badge.hot {      border-color: var(--hazard);      color: var(--hazard);      box-shadow: var(--hazard-glow);    }    .badge.mode {      border-color: rgba(22,242,170,0.9);      color: var(--accent);    }    /* TAPE VIEWS ---------------------------------------------------------- */    .tape-viewport {      flex: 1;      overflow: hidden;      position: relative;      margin-top: 0.3rem;    }    .tape-view {      position: absolute;      inset: 0;      padding: 0.65rem 0.4rem 0.7rem 0.2rem;      opacity: 0;      pointer-events: none;      transform: translateY(18px);      transition:        opacity 0.35s ease-out,        transform 0.35s ease-out;      overflow: auto;      scrollbar-width: thin;    }    .tape-view::-webkit-scrollbar {      width: 6px;    }    .tape-view::-webkit-scrollbar-track {      background: #050915;    }    .tape-view::-webkit-scrollbar-thumb {      background: linear-gradient(to bottom, #16f2aa, #fbbf24);      border-radius: 999px;    }    .tape-view.active {      opacity: 1;      pointer-events: auto;      transform: translateY(0);    }    /* CONTENT UTILITIES --------------------------------------------------- */    h2, h3, h4 {      margin: 0.5rem 0 0.3rem 0;      font-weight: 600;      letter-spacing: 0.12em;      text-transform: uppercase;    }    h2 { font-size: 0.9rem; color: var(--accent); }    h3 { font-size: 0.84rem; color: var(--accent2); }    h4 { font-size: 0.8rem; color: var(--text); }    p {      margin: 0.25rem 0 0.35rem 0;      font-size: 0.8rem;      color: #d1fae5;      line-height: 1.4;    }    code, pre {      font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;      font-size: 0.74rem;    }    pre {      margin: 0.35rem 0 0.65rem 0;      padding: 0.55rem 0.7rem;      border-radius: var(--radius-md);      background: radial-gradient(circle at 0 0, #020617 0, #020617 55%);      border: 1px solid rgba(30,64,175,0.8);      color: #e0f2fe;      overflow-x: auto;    }    .grid-2 {      display: grid;      grid-template-columns: repeat(2, minmax(0, 1fr));      gap: 0.7rem;    }    @media (max-width: 900px) {      .grid-2 { grid-template-columns: minmax(0, 1fr); }    }    .card {      border-radius: var(--radius-md);      border: 1px solid rgba(15,23,42,0.9);      background: radial-gradient(circle at 0 0, rgba(15,23,42,0.9) 0, #020617 65%);      box-shadow: 0 8px 26px rgba(0,0,0,0.9);      padding: 0.5rem 0.65rem 0.6rem 0.65rem;    }    .card-title {      font-size: 0.78rem;      letter-spacing: 0.18em;      text-transform: uppercase;      color: var(--accent);      margin-bottom: 0.3rem;    }    .chip-row {      display: flex;      flex-wrap: wrap;      gap: 0.3rem;      margin-top: 0.25rem;    }    .chip {      font-size: 0.68rem;      padding: 0.08rem 0.45rem;      border-radius: 999px;      border: 1px solid rgba(148,163,184,0.8);      color: rgba(209,213,219,0.95);    }    .chip.green {      border-color: rgba(22,242,170,0.9);      color: var(--accent);    }    .chip.hazard {      border-color: var(--hazard);      color: var(--hazard);    }    .mono-small {      font-size: 0.72rem;      color: var(--muted);    }    .divider {      height: 1px;      border-radius: 999px;      background: linear-gradient(to right, rgba(15,23,42,0.2), rgba(22,242,170,0.7), rgba(251,191,36,0.9), rgba(15,23,42,0.2));      margin: 0.3rem 0 0.4rem 0;    }    .note {      font-size: 0.74rem;      color: #f9fafb;      background: rgba(22,163,74,0.16);      border-radius: 11px;      border: 1px solid rgba(22,163,74,0.6);      padding: 0.35rem 0.5rem;      margin: 0.5rem 0;    }    .note.hazard {      background: rgba(251,191,36,0.16);      border-color: rgba(251,191,36,0.9);      color: #fef3c7;    }    .pill-row {      display: flex;      flex-wrap: wrap;      gap: 0.3rem;      margin: 0.2rem 0 0.3rem 0;    }    .pill {      border-radius: 999px;      padding: 0.12rem 0.5rem;      border: 1px solid rgba(148,163,184,0.7);      font-size: 0.68rem;      color: rgba(209,213,219,0.95);    }    .pill.mode {      border-color: rgba(22,242,170,0.9);      color: var(--accent);    }    .pill.hazard {      border-color: var(--hazard);      color: var(--hazard);    }  </style></head><body>  <!-- HUD HEADER -->  <header class="hud">    <div class="wrap">      <div class="logo-mark">        <div class="logo-glyph"></div>        <div>          <div class="logo-text-main">ASX ATOMIC MEGA CODEX</div>          <div class="logo-text-sub">XCFE · XJSON · K’UHUL · AST · ATOMIC · CMS · RLHF</div>        </div>      </div>      <div class="hud-status">        <div class="led on" id="hud-led"></div>        <span id="hud-status-text">ONLINE · LOCAL ASXR</span>        <span class="hud-pill" id="active-tape-pill">TAPE: XJSON-PRIME</span>      </div>    </div>  </header>  <!-- SHELL -->  <div class="shell">    <!-- NAV / TAPE LIST -->    <aside class="nav-panel">      <div class="nav-title">        <span>CODEX TAPES</span>        <span>ATOMIC INDEX Ω</span>      </div>      <div class="nav-search">        <span class="nav-search-icon">⌕</span>        <input id="nav-filter" placeholder="filter: xjson, xcfe, cms, rlhf, kuhu…" />      </div>      <ul class="nav-list" id="nav-list">        <!-- populated by JS -->      </ul>    </aside>    <!-- MAIN PANEL -->    <main class="main-panel">      <div class="main-header">        <div class="main-title-block">          <div class="main-title" id="main-title">ASX CODEX</div>          <div class="main-subtitle" id="main-subtitle">            Atomic ghost-guide of the entire ASX stack: XCFE, XJSON, K’uhul, AST, SCXQ2, HIVE, CMS, RLHF, and ASX-RAM — all rendered as tapes in one HUD.          </div>        </div>        <div class="main-meta">          <span class="badge hot">HAZARD · ATOMIC Ω</span>          <span class="badge mode">LOCAL-ONLY · OFFLINE-FIRST</span>        </div>      </div>      <div class="tape-viewport">        <!-- ============================================================= -->        <!-- CORE TAPES (FROM ORIGINAL MEGA CODEX)                         -->        <!-- ============================================================= -->        <!-- TAPE: XJSON PRIME SPEC -->        <section          class="tape-view active"          id="tape-xjson-prime"          data-tape-id="xjson-prime"          data-title="XJSON PRIME SPEC"          data-subtitle="Unified JSON OS language with XCFE control-flow and static REST mesh."          data-tags="xjson,language,xcfe,os,server"        >          <div class="grid-2">            <div class="card">              <div class="card-title">XJSON as OS Law</div>              <div class="divider"></div>              <p>                XJSON is the **single OS language**: apps, agents, CMS entries, tapes,                HIVE maps, and backend routes are all defined as structured JSON with                XCFE tags like <code>@if/@then/@else</code> and <code>@route</code>.              </p>              <pre>{  "$schema": "xjson://v1/app",  "@context": "asx://atomic/os",  "@law": "ASX = XCFE = XJSON = KUHUL = AST",  "meta": {    "id": "atomic_codex",    "title": "ASX Atomic Mega Codex",    "version": "1.0.0-omega"  },  "routes": {    "/codex": { "@view": "codex.index" },    "/cms":   { "@view": "cms.dashboard" }  },  "logic": {    "guard.online": {      "@if":   ["$os.health.ok"],      "@then": { "@return": "ONLINE" },      "@else": { "@return": "DEGRADED" }    }  }}</pre>              <p class="mono-small">                Every other tape in this guide is just **XJSON views + KUHUL execution**.              </p>            </div>            <div class="card">              <div class="card-title">/xjson/run Mesh</div>              <div class="divider"></div>              <p>                Any node that exposes <code>/xjson/run</code> can execute these programs.                HIVE and KLH just broadcast to many nodes and collect results.              </p>              <pre>// Browser helperasync function xjsonRun(baseUrl, program, context = {}) {  const res = await fetch(    baseUrl.replace(/\/$/, "") + "/xjson/run",    {      method: "POST",      headers: { "Content-Type": "application/json" },      body: JSON.stringify({ program, context })    }  );  const data = await res.json();  if (!data.ok) throw new Error(data.error || "XJSON error");  return data.result;}</pre>              <p class="note">                Think: **“JSON, but executable”** — XCFE is the control-flow, K’uhul is the engine.              </p>            </div>          </div>        </section>        <!-- TAPE: ATOMIC HTML SYSTEM -->        <section          class="tape-view"          id="tape-atomic-html"          data-tape-id="atomic-html"          data-title="ATOMIC HTML RUNTIME"          data-subtitle="Micro-layout engine with Atomic CSS blocks and Ghost UI."          data-tags="atomic,html,css,blocks,ui"        >          <div class="grid-2">            <div class="card">              <div class="card-title">Atomic Layout Blocks</div>              <div class="divider"></div>              <p>                Atomic HTML replaces frameworks with a **tiny vocabulary**:                <code>.row</code>, <code>.col</code>, <code>.grid-2</code>,                <code>.card</code>, <code>.chip</code>, etc. The Codex itself is                just Atomic HTML + XJSON tape data.              </p>              <pre>&lt;div class="row gap-md align-center"&gt;  &lt;div class="chip chip-green"&gt;ASX&lt;/div&gt;  &lt;h2&gt;Atomic Ghost UI&lt;/h2&gt;&lt;/div&gt;&lt;div class="grid-2 gap-md mt-md"&gt;  &lt;article class="card"&gt;...&lt;/article&gt;  &lt;article class="card"&gt;...&lt;/article&gt;&lt;/div&gt;</pre>              <p class="mono-small">                All layouts in this HUD follow the **4-block Atomic CSS rule**.              </p>            </div>            <div class="card">              <div class="card-title">CSS as Runtime</div>              <div class="divider"></div>              <p>                In ASX, CSS variables + classes are a **runtime surface**. Manifest                and KUHUL tweak classes like <code>.mode-cms</code> or                <code>.mode-forum</code> to flip entire UIs.              </p>              <pre>:root {  --gap-sm: .35rem;  --gap-md: .7rem;}.row { display:flex; align-items:flex-start; }.col { display:flex; flex-direction:column; }.grid-2 { display:grid; grid-template-columns: repeat(2,minmax(0,1fr)); }.card { border-radius: 12px; }</pre>              <p class="note">                Atomic HTML is the **visual dialect** for the CMS, RLHF, and Codex.              </p>            </div>          </div>        </section>        <!-- TAPE: SCXQ2 ENGINE -->        <section          class="tape-view"          id="tape-scxq2"          data-tape-id="scxq2-engine"          data-title="SCXQ2 CIPHER ENGINE"          data-subtitle="Symbolic compression for tapes, n-grams, and OS glyphs."          data-tags="scx,scxq2,cipher,compression"        >          <div class="grid-2">            <div class="card">              <div class="card-title">SCXQ2-Lite (Browser)</div>              <div class="divider"></div>              <p>                In-browser we use SCXQ2-lite: base64-wrapped JSON compactor                that hides heavy grammar behind tiny glyph payloads.              </p>              <pre>const SCXQ2 = {  encode(str) {    return btoa(unescape(encodeURIComponent(str)));  },  decode(payload) {    try { return decodeURIComponent(escape(atob(payload))); }    catch { return ""; }  }};const packed = SCXQ2.encode(JSON.stringify({  tape: "ai_cms",  v: "1.0.0"}));</pre>              <p class="note">                Full SCXQ2 adds dictionary + RLE + Huffman for extreme compression.              </p>            </div>            <div class="card">              <div class="card-title">N-Gram Compression</div>              <div class="divider"></div>              <p>                MX2LM, CMS, and RLHF store n-gram bursts as SCX packets:                cheaper to sync, trivial to expand in the browser.              </p>              <pre>async function pushNgram(text, score) {  const grams = extractNgrams(text);  const burst = { grams, score, ts: Date.now() };  const payload = SCXQ2.encode(JSON.stringify(burst));  await fetch("/api/ngrams/burst", {    method: "POST",    headers: { "Content-Type": "application/x-scxq2" },    body: payload  });}</pre>            </div>          </div>        </section>        <!-- TAPE: K’UHUL RUNTIME -->        <section          class="tape-view"          id="tape-kuhul"          data-tape-id="kuhul-runtime"          data-title="K’UHUL RUNTIME"          data-subtitle="Spatial execution engine for XJSON, CMS, RLHF, and SVG-3D."          data-tags="kuhul,runtime,trainer,svg3d"        >          <div class="grid-2">            <div class="card">              <div class="card-title">K’UHUL Execution Law</div>              <div class="divider"></div>              <p>                K’uhul is the **runtime of everything**: it reads XJSON,                resolves XCFE control vectors, and updates DOM, CMS,                ASX-RAM, or SVG-3D scenes.              </p>              <pre>{  "@engine": "KUHUL_PI",  "@phase": "@Sek",  "@op": "cms.render",  "@input": {    "mode": "forum",    "thread_id": "rlhf_case_42"  },  "@output": "@DOM"}</pre>              <p class="note">                In the Codex, think of K’uhul as “how the guide actually moves.”              </p>            </div>            <div class="card">              <div class="card-title">ASX-RAM Bridge</div>              <div class="divider"></div>              <p>                Instead of localStorage, K’uhul talks to **ASX-RAM** via                service worker messages, keeping CMS state, n-grams, and RLHF                traces in sync.              </p>              <pre>const ASXRAM = {  store(key, value) {    if (!navigator.serviceWorker?.controller) return;    navigator.serviceWorker.controller.postMessage({      type: "ram-store",      key, value    });  },  get(key) {    return new Promise(resolve =&gt; {      if (!navigator.serviceWorker?.controller) return resolve(null);      const handler = (e) =&gt; {        if (e.data?.type === "ram-data" &amp;&amp; e.data.key === key) {          navigator.serviceWorker.removeEventListener("message", handler);          resolve(e.data.value);        }      };      navigator.serviceWorker.addEventListener("message", handler);      navigator.serviceWorker.controller.postMessage({        type: "ram-get",        key      });    });  }};</pre>            </div>          </div>        </section>        <!-- TAPE: KLH HIVE-NET -->        <section          class="tape-view"          id="tape-klh"          data-tape-id="klh-hivenet"          data-title="KLH HIVE-NET"          data-subtitle="Mesh orchestrator over XJSON nodes and quantum traffic."          data-tags="klh,hive,mesh,router"        >          <div class="grid-2">            <div class="card">              <div class="card-title">Multi-Hive Map</div>              <div class="divider"></div>              <p>                KLH is the **router brain** that knows about all hives:                CMS, trainer, quantum, worlds, education, etc. Each hive is                just a shard with capabilities and routes.              </p>              <pre>{  "node_id": "prime-cms",  "capabilities": ["cms","rlhf","search"],  "routes": {    "/cms/query": { "@kind": "xjson", "@target": "/xjson/run" },    "/trainer/step": { "@kind": "queue", "@target": "gpu-trainer-01" }  }}</pre>            </div>            <div class="card">              <div class="card-title">HIVE Console Idea</div>              <div class="divider"></div>              <p>                A small dashboard pings each node and shows ONLINE /                DEGRADED / OFF, all driven by XJSON health checks.              </p>              <pre>// pseudo-frontendconst servers = await fetch("./servers.json").then(r =&gt; r.json());for (const node of servers) {  xjsonRun(node.url, { "@check": "health" }).then(markOnline);}</pre>            </div>          </div>        </section>        <!-- TAPE: MX2 CROWN -->        <section          class="tape-view"          id="tape-mx2-crown"          data-tape-id="mx2-crown"          data-title="MX2 CROWN RUNTIME"          data-subtitle="Personality caps, tape-based model routing, and token gates."          data-tags="crown,mx2,token,market"        >          <div class="grid-2">            <div class="card">              <div class="card-title">Crown Definition</div>              <div class="divider"></div>              <p>                A **Crown** is a personality capsule: theme, lexicon,                allowed tools, and backing model tape.              </p>              <pre>{  "id": "mx2_cms_assistant",  "name": "CMS Architect",  "theme": { "color": "#fbbf24", "icon": "⚠️" },  "api_tape": "openai_gpt4_turbo.json",  "lexicon": "cms_architect_lexicon.json",  "token_cost": 50,  "capabilities": ["docs","specs","migrations"]}</pre>            </div>            <div class="card">              <div class="card-title">Tape-Based Routing</div>              <div class="divider"></div>              <p>                Models are **tapes**, not hard-coded HTTP. The runtime reads                the tape and sends requests accordingly.              </p>              <pre>{  "name": "OpenAI GPT-4 Turbo",  "endpoint": "https://api.openai.com/v1/chat/completions",  "headers": {    "Authorization": "Bearer {API_KEY}",    "Content-Type": "application/json"  },  "body_template": {    "model": "gpt-4.1-mini",    "messages": "{MESSAGES}"  },  "response_path": "choices[0].message.content"}</pre>            </div>          </div>        </section>        <!-- TAPE: BASHER + ASX BRIDGE -->        <section          class="tape-view"          id="tape-basher"          data-tape-id="basher-bridge"          data-title="BASHER & ASX-BRIDGE"          data-subtitle="Local static bridge + CLI orchestrator for tunnels and training."          data-tags="basher,bridge,cli"        >          <div class="grid-2">            <div class="card">              <div class="card-title">ASX-BRIDGE</div>              <div class="divider"></div>              <p>                <code>asx-bridge.js</code> is a zero-dependency HTTP server that                serves this Codex + CMS + assets as static files.              </p>              <pre>const http = require("http");const fs = require("fs");const path = require("path");const ROOT = path.join(__dirname, "..");const PORT = process.env.PORT || 3000;http.createServer((req, res) =&gt; {  let pathname = decodeURIComponent(req.url || "/");  if (pathname === "/") pathname = "/index.html";  const filePath = path.join(ROOT, pathname);  fs.readFile(filePath, (err, data) =&gt; {    if (err) {      res.writeHead(404);      return res.end("Not found");    }    res.writeHead(200);    res.end(data);  });}).listen(PORT);</pre>            </div>            <div class="card">              <div class="card-title">Basher Commands</div>              <div class="divider"></div>              <p>                Basher is the **cockpit CLI**: start bridge, open tunnels,                run trainers, inspect logs, all as XJSON commands.              </p>              <pre>{  "cmd": "bridge.start",  "port": 3000}{  "cmd": "trainer.run",  "tape": "tape_system_trinity_runtime_v1"}</pre>            </div>          </div>        </section>        <!-- TAPE: TAPES & HOLOTAPES -->        <section          class="tape-view"          id="tape-holotapes"          data-tape-id="asx-tapes"          data-title="ASX TAPES & HOLOTAPES"          data-subtitle="Cartridges that bundle brains, agents, routes, logs, and UI."          data-tags="tapes,holotape,forge"        >          <div class="grid-2">            <div class="card">              <div class="card-title">Tape Layout</div>              <div class="divider"></div>              <p>                Each tape is a mini-OS: brains, agents, db, logs, public UI.                The AI CMS itself is just a **system tape**.              </p>              <pre>/tapes/  └── ai_cms/      ├── brains/      ├── agents/      ├── db/      ├── logs/      ├── public/      └── tape.json</pre>            </div>            <div class="card">              <div class="card-title">Self-Registration</div>              <div class="divider"></div>              <p>                Tapes announce themselves via heartbeats to the service worker                and KLH router.              </p>              <pre>&lt;script&gt;(function () {  const TAPE_ID = "ai_cms";  function ping() {    if (!navigator.serviceWorker?.controller) return;    navigator.serviceWorker.controller.postMessage({      type: "TAPE_HEARTBEAT",      tape: TAPE_ID,      time: Date.now(),      meta: { title: "AI CMS Backbone" }    });  }  window.addEventListener("load", () =&gt; {    ping();    setInterval(ping, 5000);  });})();&lt;/script&gt;</pre>            </div>          </div>        </section>        <!-- TAPE: PRIME OS -->        <section          class="tape-view"          id="tape-prime-os"          data-tape-id="prime-os"          data-title="PRIME OS & COCKPITS"          data-subtitle="Single-page OS shells, judge views, and multi-agent HUDs."          data-tags="prime-os,cockpit,judge"        >          <div class="grid-2">            <div class="card">              <div class="card-title">Single-Page Shell</div>              <div class="divider"></div>              <p>                PRIME OS is one big HTML shell: login + cockpit + CMS +                trainer panes, all swapped by CSS visibility.              </p>              <pre>&lt;body&gt;  &lt;div id="boot"&gt;&lt;/div&gt;  &lt;div id="os" hidden&gt;&lt;/div&gt;  &lt;script&gt;    async function bootPrime() {      // check auth, load shards, attach SW...      document.getElementById("boot").hidden = true;      document.getElementById("os").hidden = false;    }  &lt;/script&gt;&lt;/body&gt;</pre>            </div>            <div class="card">              <div class="card-title">Multi-Agent Judge</div>              <div class="divider"></div>              <p>                Judge views coordinate MX2LM + Qwen + tools as a panel of                agents, with a single final “verdict” tape.              </p>              <pre>{  "prompt": "Refactor CMS manifest",  "agents": ["mx2lm","qwen"],  "coordinator": "judge",  "flow": [    "coordinator.select_primary",    "primary.respond",    "secondary.comment",    "judge.summarize"  ]}</pre>            </div>          </div>        </section>        <!-- TAPE: GEOMETRY STACK -->        <section          class="tape-view"          id="tape-geometry"          data-tape-id="prime-geometry"          data-title="GEOMETRY & WEBGL"          data-subtitle="Worlds, terrain, voxels, and spotlights as render tapes."          data-tags="webgl,three,geometry"        >          <div class="grid-2">            <div class="card">              <div class="card-title">Terrain & Voxels</div>              <div class="divider"></div>              <p>                The 3D layer is a library of **render tapes**: each one                mounts a world into PRIME OS or AI CMS dashboards.              </p>              <pre>// Example: heightfield planeconst geometry = new THREE.PlaneGeometry(  7500, 7500,  width - 1, depth - 1);geometry.rotateX(-Math.PI / 2);// mutate vertices from height data...</pre>            </div>            <div class="card">              <div class="card-title">Spotlights & BVH</div>              <div class="divider"></div>              <p>                Other tapes demo spotlight shadows, BVH, and LOD tricks                to keep things smooth on modest machines.              </p>              <pre>const spotLight = new THREE.SpotLight(0xffffff, 100);spotLight.position.set(2.5, 5, 2.5);spotLight.angle = Math.PI / 6;spotLight.castShadow = true;</pre>            </div>          </div>        </section>        <!-- ============================================================= -->        <!-- BLACK CODEX TAPES (NEW, MERGED)                               -->        <!-- ============================================================= -->        <!-- TAPE: BLACK — XCFE ⊗ K’UHUL ⊗ XJSON ⊗ AST ⊗ ATOMIC -->        <section          class="tape-view"          id="tape-black-xcfe-kuhul-omega"          data-tape-id="black-xcfe-kuhul-omega"          data-title="Ω CONTROL FLOW PANEL"          data-subtitle="XCFE governs control; K’uhul executes; XJSON encodes; AST verifies; ATOMIC renders."          data-tags="xcfe,kuhul,xjson,ast,atomic"        >          <div class="grid-2">            <div class="card">              <div class="card-title">Ω Law</div>              <div class="divider"></div>              <p>                The core identity:                <strong>ASX = XCFE = XJSON = K’uhul = AST = ATOMIC_BLOCK</strong>.                Everything in the system is a **block of vectors, states, and flows**.              </p>              <pre>{  "立v": "Ω.1.0",  "n": "XCFE_KUHUL_XJSON_AST_ATOMIC_OMEGA",  "@law": "ASX = XCFE = XJSON = KUHUL = AST",  "@architecture": "atomic_block_lattice",  "@control": ["@Pop","@Wo","@Sek","@Xul","@Ch'en"],  "@variable": ["@entropy","@innovation","@loop_state"]}</pre>              <p class="note hazard">                Ω-panel reminder: **XCFE = control**, **K’uhul = physics**, **AST = firewall**.              </p>            </div>            <div class="card">              <div class="card-title">Execution Stages</div>              <div class="divider"></div>              <p>                Five canonical stages govern any flow (CMS, RLHF, Doom world,                trainer loop):              </p>              <ul style="margin:0.25rem 0 0.4rem 1rem;font-size:0.78rem;color:#e5e7eb;">                <li><strong>@Pop</strong> — perception / input</li>                <li><strong>@Wo</strong> — representation / parsing</li>                <li><strong>@Sek</strong> — execution / physics</li>                <li><strong>@Xul</strong> — world / DOM mutation</li>                <li><strong>@Ch’en</strong> — reflection / logging</li>              </ul>              <pre>{  "@stage": "@Sek",  "@op": "cms.save.entry",  "@input": { "mode": "forum", "id": "case_101" },  "@output": "@Xul"}</pre>            </div>          </div>        </section>        <!-- TAPE: BLACK — DNS HIVE KERNEL / API–DOM BACKEND -->        <section          class="tape-view"          id="tape-black-dns-hive-kernel"          data-tape-id="black-dns-hive-kernel"          data-title="DNS HIVE KERNEL"          data-subtitle="Browser backend: DNS authority, REST mesh, and API–DOM bridge."          data-tags="dns,hive,api,dom,backend"        >          <div class="grid-2">            <div class="card">              <div class="card-title">DNS as OS Index</div>              <div class="divider"></div>              <p>                The Hive kernel treats DNS zones as **OS folders**:                <code>xjson.app</code>, <code>rig.xjson.app</code>,                <code>hive.xjson.app</code>, etc. map to shards.              </p>              <pre>{  "dns_zones": {    "xjson.app":     "prime-ui",    "rig.xjson.app": "backend-rig",    "hive.xjson.app":"multi-hive-console"  },  "authority": "sw.khl"}</pre>              <p class="note">                The browser’s service worker is the “DNS server” for the OS.              </p>            </div>            <div class="card">              <div class="card-title">API–DOM Bridge</div>              <div class="divider"></div>              <p>                All traffic flows: **API → JSON → K’uhul → DOM**.                No direct DB / DOM hacks; the bridge is the only path.              </p>              <pre>// Example: CMS query from DOMconst program = {  "@op": "cms.query",  "@input": { "mode": "forum", "q": "rlhf" }};xjsonRun("/xjson", program).then(renderResults);</pre>            </div>          </div>        </section>        <!-- TAPE: BLACK — ASX RAM + N-GRAM COGNITION -->        <section          class="tape-view"          id="tape-black-asx-ram"          data-tape-id="black-asx-ram-cognition"          data-title="ASX-RAM & N-GRAM STACK"          data-subtitle="Unigrams → Supagrams → Glyphgrams as the OS memory pyramid."          data-tags="asx-ram,ngrams,memory"        >          <div class="grid-2">            <div class="card">              <div class="card-title">Memory Ladder</div>              <div class="divider"></div>              <p>                ASX-RAM uses a 5+ level memory ladder:              </p>              <div class="pill-row">                <span class="pill mode">Unigrams</span>                <span class="pill mode">Bigrams</span>                <span class="pill mode">Quadragrams</span>                <span class="pill mode">Pentagrams</span>                <span class="pill mode">Supagrams</span>                <span class="pill mode">Glyphgrams</span>              </div>              <pre>{  "@ram": {    "levels": ["uni","bi","quad","penta","supra","glyph"],    "policy": "rlhf_weighted_decay"  }}</pre>            </div>            <div class="card">              <div class="card-title">RLHF Integration</div>              <div class="divider"></div>              <p>                Every RLHF verdict updates ASX-RAM weights; CMS and agents                read those weights to guide UI and routing.              </p>              <pre>// RLHF log → ASX-RAM update{  "@op": "ram.update",  "@input": {    "supagram": "kuhul+xjson+cms",    "delta": +0.12,    "source": "rlhf_forum_case_77"  }}</pre>            </div>          </div>        </section>        <!-- TAPE: BLACK — K’UHUL ⊗ XCFE EXECUTION -->        <section          class="tape-view"          id="tape-black-kuhul-xcfe"          data-tape-id="black-kuhul-xcfe-execution"          data-title="K’UHUL ⊗ XCFE EXECUTION"          data-subtitle="Control vectors decide; K’uhul executes; AST validates each step."          data-tags="xcfe,kuhul,execution"        >          <div class="grid-2">            <div class="card">              <div class="card-title">Control vs Physics</div>              <div class="divider"></div>              <p>                XCFE is the **if/then/else brain**. K’uhul is the **spatial                physics engine** that actually runs the decision.              </p>              <pre>{  "@control": {    "@if":   ["$cms.mode == 'forum'"],    "@then": { "@op": "cms.render.forum" },    "@else": { "@op": "cms.render.store" }  },  "@engine": "KUHUL_PI"}</pre>            </div>            <div class="card">              <div class="card-title">AST Firewall</div>              <div class="divider"></div>              <p>                Before K’uhul executes, AST validates the tree:                no forbidden ops, no invalid shapes, no broken flows.              </p>              <pre>{  "@ast": {    "@check": [      "no_unknown_tags",      "flow_has_stage",      "security_constraints_ok"    ]  }}</pre>            </div>          </div>        </section>        <!-- TAPE: BLACK — QUANTUM TRAFFIC MATRIX -->        <section          class="tape-view"          id="tape-black-quantum-traffic"          data-tape-id="black-quantum-traffic"          data-title="QUANTUM TRAFFIC MATRIX"          data-subtitle="Unified handler for HTTP, WS, SSE, RPC, file, and realtime flows."          data-tags="traffic,quantum,router"        >          <div class="grid-2">            <div class="card">              <div class="card-title">Traffic Handlers</div>              <div class="divider"></div>              <p>                The Quantum Traffic Matrix describes how all connection                types map into the same KUHUL execution fabric.              </p>              <pre>⟁ quantum_traffic_handler  ⟁Wo⟁ version "6.1.0"  ⟁Wo⟁ traffic_handlers {    "http":  quantum_http_handler,    "ws":    quantum_websocket_handler,    "rest":  quantum_rest_handler,    "rpc":   quantum_rpc_handler,    "file":  quantum_file_handler,    "stream":quantum_stream_handler  }</pre>            </div>            <div class="card">              <div class="card-title">AI CMS View</div>              <div class="divider"></div>              <p>                For the CMS, this means: the same handler can serve page                HTML, JSON API responses, RLHF streams, and logs.              </p>              <pre>{  "@route": "/cms/events",  "@type": "sse",  "@handler": "quantum_sse_handler",  "@source": "cms.rlhf.timeline"}</pre>            </div>          </div>        </section>        <!-- TAPE: BLACK — SECURITY GOAT (POLYGLOT / PI GOAT) -->        <section          class="tape-view"          id="tape-black-security-goat"          data-tape-id="black-security-goat"          data-title="SECURITY GOAT (PI-GOAT)"          data-subtitle="Polyglot guardian that scores, filters, and blocks unsafe flows."          data-tags="security,goat,polyglot"        >          <div class="grid-2">            <div class="card">              <div class="card-title">Threat Scoring</div>              <div class="divider"></div>              <p>                PI-GOAT is a **polyglot security agent**. It sees all                requests as XJSON, applies rules, and gates them.              </p>              <pre>{  "@op": "@security.goat.evaluate",  "@input": {    "route": "/cms/save",    "payload": "{...}",    "user_role": "author"  },  "@output": "@allow_or_block"}</pre>              <p class="note hazard">                SECURITY GOAT = “does this route get to run at all?”.              </p>            </div>            <div class="card">              <div class="card-title">Multi-Language Checks</div>              <div class="divider"></div>              <p>                Because everything is normalized into XJSON/AST, PI-GOAT                doesn’t care if the source was HTTP, WS, or plugin; it just                sees a structural tree.              </p>              <pre>{  "@rules": [    "no_raw_sql_literals",    "no_external_eval",    "plugin_scope_isolated"  ]}</pre>            </div>          </div>        </section>        <!-- TAPE: BLACK — RLHF TRAINER & FORUM -->        <section          class="tape-view"          id="tape-black-rlhf"          data-tape-id="black-rlhf-trainer"          data-title="RLHF FORUM & TRAINER"          data-subtitle="Human feedback flows turn into training data, scores, and memory updates."          data-tags="rlhf,forum,trainer"        >          <div class="grid-2">            <div class="card">              <div class="card-title">Forum as Data Engine</div>              <div class="divider"></div>              <p>                The RLHF Forum isn’t just UI — it’s a **data pump** that                sends scored threads into ASX-RAM and training tapes.              </p>              <pre>{  "@op": "rlhf.record_case",  "@input": {    "thread_id": "cms_case_12",    "score": 0.87,    "labels": ["Prompt Design","Safety & Policy"],    "snippet": "model repeats user private info"  }}</pre>            </div>            <div class="card">              <div class="card-title">Trainer Loop</div>              <div class="divider"></div>              <p>                A trainer tape consumes RLHF cases, batches them, and                pushes updates to MX2LM/Qwen or external trainers.              </p>              <pre>{  "@tape": "tape_system_rlhf_forum_v1",  "@loop": {    "@source": "rlhf_cases",    "@batch_size": 32,    "@target_model": "qwenf1-asx",    "@log": "training_runs"  }}</pre>            </div>          </div>        </section>        <!-- TAPE: BLACK — AI POWERED CMS OS -->        <section          class="tape-view"          id="tape-black-ai-cms"          data-tape-id="black-ai-cms-os"          data-title="AI POWERED CMS OS"          data-subtitle="Native backbone CMS: forum, store, plugins, blog, users, RLHF — all in one XJSON OS."          data-tags="cms,ai,os,asx-ram"        >          <div class="grid-2">            <div class="card">              <div class="card-title">Backbone Manifest</div>              <div class="divider"></div>              <p>                The AI CMS is a **native OS tape** that organizes all                content into modes and entities using XJSON.              </p>              <pre>{  "@context": "asx://cms/os",  "modes": ["forum","store","plugins","blog","users","rlhf"],  "entities": {    "forum.thread": { "title": "string", "body": "string", "labels": "[]string" },    "store.item":   { "name": "string", "price": "number" }  }}</pre>              <p class="note">                This tape is the **spine** for your App-Builder and content world.              </p>            </div>            <div class="card">              <div class="card-title">Agents & ASX-RAM</div>              <div class="divider"></div>              <p>                Three core agents are wired into this CMS:              </p>              <div class="pill-row">                <span class="pill mode">agent.profile.manager</span>                <span class="pill mode">agent.memory.trainer</span>                <span class="pill mode">agent.rlhf.reinforcer</span>              </div>              <p style="margin-top:0.25rem;">                They read CMS events, update ASX-RAM, and decorate the UI                with “what matters right now”.              </p>              <pre>{  "@agent": "profile.manager",  "@on": ["cms.user.login","cms.user.update"],  "@effect": "@ram.store.user_profile_summary"}</pre>            </div>          </div>        </section>      </div>    </main>  </div>  <!-- ASXR GHOST INDEX + SCXQ2 WIRING -->  <script>    // ASXR_GHOST_INDEX — each entry is a tape description to drive the sidebar.    const ASXR_GHOST_INDEX = [      {        id: "xjson-prime",        label: "XJSON PRIME",        subtitle: "Language · XCFE · /xjson/run mesh",        tags: ["xjson","language","xcfe","server"]      },      {        id: "atomic-html",        label: "ATOMIC HTML",        subtitle: "Blocks · Layout · Ghost UI",        tags: ["atomic","html","css","ui"]      },      {        id: "scxq2-engine",        label: "SCXQ2 ENGINE",        subtitle: "Cipher · Compression · N-grams",        tags: ["scx","cipher","compression"]      },      {        id: "kuhul-runtime",        label: "K’UHUL RUNTIME",        subtitle: "Execution · ASX-RAM · Trainer",        tags: ["kuhul","trainer","runtime"]      },      {        id: "klh-hivenet",        label: "KLH HIVE-NET",        subtitle: "Mesh · Multi-hive · Router",        tags: ["klh","hive","mesh"]      },      {        id: "mx2-crown",        label: "MX2 CROWN",        subtitle: "Crowns · APIs · Tokens",        tags: ["crown","market","token"]      },      {        id: "basher-bridge",        label: "BASHER + BRIDGE",        subtitle: "CLI · Tunnels · Logs",        tags: ["basher","bridge","cli"]      },      {        id: "asx-tapes",        label: "TAPES / HOLOTAPES",        subtitle: "Cartridges · Brains · Agents",        tags: ["tapes","holotape"]      },      {        id: "prime-os",        label: "PRIME OS",        subtitle: "Single-page OS · Judge",        tags: ["prime","os","cockpit"]      },      {        id: "prime-geometry",        label: "GEOMETRY STACK",        subtitle: "WebGL · Terrain · Voxels",        tags: ["webgl","three","geometry"]      },      // BLACK CODEX TAPES      {        id: "black-xcfe-kuhul-omega",        label: "Ω CONTROL FLOW",        subtitle: "XCFE ⊗ K’uhul ⊗ XJSON ⊗ AST ⊗ ATOMIC",        tags: ["omega","xcfe","kuhul"]      },      {        id: "black-dns-hive-kernel",        label: "DNS HIVE KERNEL",        subtitle: "DNS authority · REST mesh · API–DOM bridge",        tags: ["dns","hive","backend"]      },      {        id: "black-asx-ram-cognition",        label: "ASX-RAM COGNITION",        subtitle: "N-grams → Supagrams → Glyphgrams",        tags: ["asx-ram","ngrams","memory"]      },      {        id: "black-kuhul-xcfe-execution",        label: "K’UHUL ⊗ XCFE",        subtitle: "Control vectors · Execution physics · AST firewall",        tags: ["xcfe","kuhul","ast"]      },      {        id: "black-quantum-traffic",        label: "QUANTUM TRAFFIC",        subtitle: "HTTP · WS · SSE · RPC · Stream",        tags: ["traffic","quantum","router"]      },      {        id: "black-security-goat",        label: "SECURITY GOAT",        subtitle: "Polyglot guardian · PI-GOAT",        tags: ["security","goat","polyglot"]      },      {        id: "black-rlhf-trainer",        label: "RLHF FORUM",        subtitle: "Human feedback · Trainer loops · Scores",        tags: ["rlhf","forum","trainer"]      },      {        id: "black-ai-cms-os",        label: "AI CMS BACKBONE",        subtitle: "Forum · Store · Plugins · Blog · Users · RLHF",        tags: ["cms","ai","os"]      }    ];    // Minimal SCXQ2-lite — identity compactor for ghost index    const SCXQ2_LITE = {      pack:  obj  => btoa(unescape(encodeURIComponent(JSON.stringify(obj)))),      unpack: str => JSON.parse(decodeURIComponent(escape(atob(str))))    };    const _packedIndex = SCXQ2_LITE.pack(ASXR_GHOST_INDEX);    const ASXR_INDEX = SCXQ2_LITE.unpack(_packedIndex);    const navListEl      = document.getElementById("nav-list");    const navFilterInput = document.getElementById("nav-filter");    const mainTitleEl    = document.getElementById("main-title");    const mainSubtitleEl = document.getElementById("main-subtitle");    const activeTapePill = document.getElementById("active-tape-pill");    const views          = Array.from(document.querySelectorAll(".tape-view"));    function buildNav(items) {      navListEl.innerHTML = "";      for (const tape of items) {        const li = document.createElement("li");        li.className = "nav-item";        li.dataset.tapeId = tape.id;        const titleRow = document.createElement("div");        titleRow.className = "nav-item-title";        const firstTag = tape.tags?.[0] || "core";        const chipClass = (          firstTag.includes("omega") ||          firstTag.includes("security") ||          firstTag.includes("cms")        ) ? "nav-chip hazard" : "nav-chip";        titleRow.innerHTML =          `<span>${tape.label}</span><span class="${chipClass}">${firstTag}</span>`;        const subRow = document.createElement("div");        subRow.className = "nav-item-sub";        subRow.textContent = tape.subtitle;        li.appendChild(titleRow);        li.appendChild(subRow);        li.addEventListener("click", () => activateTape(tape.id));        navListEl.appendChild(li);      }    }    function setNavActive(tapeId) {      for (const li of navListEl.querySelectorAll(".nav-item")) {        li.classList.toggle("active", li.dataset.tapeId === tapeId);      }    }    function sendTapeHeartbeat(tapeId, title) {      // Optional REST ping      try { fetch("/api/local/" + encodeURIComponent(tapeId)); } catch {}      if (navigator.serviceWorker && navigator.serviceWorker.controller) {        navigator.serviceWorker.controller.postMessage({          type: "TAPE_HEARTBEAT",          tape: tapeId,          url: location.pathname,          time: Date.now(),          meta: {            title: title || tapeId,            codex: true,            atomic_guide: true          }        });      }      try {        const bc = new BroadcastChannel("ASX_TAPE_SYNC");        bc.postMessage({          type: "TAPE_PING",          tape: tapeId,          ts: Date.now()        });      } catch {}    }    function activateTape(tapeId) {      const view = views.find(v => v.dataset.tapeId === tapeId);      if (!view) return;      views.forEach(v => v.classList.toggle("active", v === view));      const title = view.dataset.title || tapeId;      const subtitle = view.dataset.subtitle || "";      mainTitleEl.textContent = title;      mainSubtitleEl.textContent = subtitle;      activeTapePill.textContent = "TAPE: " + tapeId.toUpperCase();      const hash = "#tape-" + tapeId;      if (location.hash !== hash) history.replaceState(null, "", hash);      sendTapeHeartbeat(tapeId, title);      setNavActive(tapeId);    }    function restoreFromHash() {      const h = location.hash.replace("#tape-", "");      if (h) {        activateTape(h);      } else {        activateTape("xjson-prime");      }    }    navFilterInput.addEventListener("input", () => {      const q = navFilterInput.value.toLowerCase().trim();      const filtered = ASXR_INDEX.filter(t => {        if (!q) return true;        const haystack = [          t.id,          t.label,          t.subtitle,          ...(t.tags || [])        ].join(" ").toLowerCase();        return haystack.includes(q);      });      buildNav(filtered);      const activeId = document.querySelector(".tape-view.active")?.dataset.tapeId;      setNavActive(activeId);    });    buildNav(ASXR_INDEX);    restoreFromHash();    window.addEventListener("hashchange", restoreFromHash);    // SERVICE WORKER REGISTRATION (safe if missing)    if ("serviceWorker" in navigator) {      navigator.serviceWorker.register("./sw.js").catch(() => {});    }  </script></body></html>